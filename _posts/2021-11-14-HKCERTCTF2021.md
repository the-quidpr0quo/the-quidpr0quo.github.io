---
layout	title
post
2021-11-14-HKCERT-CTF2021
---

This is my first CTF writeup ;)

Invited to the **HKCERT CTF 2021**, although shamefully didn't have time to fully participate in the competition, I am happy to try out one of the CTF questions written by an old friend, which happens to be my high school frd. Nice chap by the way XD

![image](https://user-images.githubusercontent.com/94167587/141699878-49579dcd-dd73-44b1-8596-f664d2fe7e0d.png)



# Starting wrongly

![image](https://user-images.githubusercontent.com/94167587/141700134-cc95a816-959c-44fb-a775-fa301abf658b.png)


Given my background, I started out wrongly by performing an Nmap scan and directory listing (gobuster) on the dedicated server without looking at the hint of this CTF question. I even attempted opened my Burp Suite Professional to inspect the Request and Responses sent to this .php written server (while contemplating what bruteforcing attack I can initiate cough...coughc.... very wrong) 

# Hints

The hint itself is actually the source code of the login.php, which sets out the criteria of the good password that should be filled in to solve this challenge. According to the background of this challenge, this challenge has already appeared in other public CTF competitions before. 
![image](https://user-images.githubusercontent.com/94167587/141700302-1c35acb5-7ab3-444c-9e72-97b7a259b0f0.png)


So if we break down the source code bits by bits, we will first know the correct username is "**hkcert**" while the rest is the criteria the password should meet, for example, the inputs should not exceed 24 characters, the inputs should not carry special characters etc. 

### the inputs should not exceed 24 characters
```
if($_SERVER["REQUEST_METHOD"] == "POST"){

    if ((strlen($_POST["username"]) > 24) or strlen($_POST["password"]) > 24) {
        header("location: https://www.youtube.com/watch?v=2ocykBzWDiM");
        exit();
    }
```

### Special characters not allowed 
Where **!!ctype_alnum** is the hint 
```
$password = trim($_POST["password"]);
            if (!ctype_alnum(trim($_POST["password"])) or !ctype_alnum(trim($_POST["username"]))) {
                switch ( rand(0,2) ) {
                    case 0:
                    header("location: https://www.youtube.com/watch?v=l7pP3ydt3tU");
                    break;
                    case 1:
                    header("location: https://www.youtube.com/watch?v=G094II5gIsI");
                    break;
                    case 2:
                    header("location: https://www.youtube.com/watch?v=0YQtsez-_D4");
                    break;
                    default:
                    header("location: https://www.youtube.com/watch?v=2ocykBzWDiM");
                    exit();
```

